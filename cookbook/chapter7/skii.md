### 项目的规划思路  
- 博客主体设计
- 阅读数（可拓展成今天来访人数、总来访人数、阁下是今天第几位访客，总阅读数）
- 用户登录验证（没有注册是因为采取第三方登录，用户只要填写昵称即可）
- 评论或留言板（代码一模一样，前端代码不一样）
- 各种小工具（友情链接、个人社交网站链接、学习书籍链接等等）  

上面的这些功能，会被写成五个应用，如果你有更多的想法，写十几个应用都可以。  
第一步，也是最重要的一步，博客主体的设计是决定了你的后面功能的实现。  
如果前期规划不好的话，需要修改博客的数据库，迁移数据库这个步骤很麻烦，因为是关系型数据库。  
困难点比较多。  
数据库设计方面可以参考前面给的**models.py**   
写前端的注意的地方是**评论**、**阅读数**、友情链接等，预留空间，等到后面讲到的时候再添加进来。  
也可以到我的github上面找关于Django的项目。只要README.md 上写了使用方法和介绍的都是可用的。  
后续也会根据本次教程，分章节生成对应的项目文件。  
### 博客这个应用的代码写作流程  
- 用笔和纸画出你的博客界面和内容位置
- 收藏Django的文档，时常阅读文档
- 根据你的图纸设计博客主体的数据库
- views.py中，每个方法只输出出一种数据（例如文章详情页就只输出文章详情的数据，其他需要的额外内容交给**自定义模板标签**负责输出）
- 配置好你的路由器，也就是urls.py
- 根据你的图纸写模板文件，并把数据传输到上面去，如果两个页面几乎一模一样的（例如博客列表和标签类型列表，写好博客列表页即可。）  
- 采取**模板拓展方法**减少代码量，提高可阅读性，方便后续维护。  

### 技巧
最重要的地方在于，**重构代码和记录过程**。  
其实我写这个教程和项目写了不少于十遍。  
但我写的每一遍都在重新敲代码，而不是复制粘贴。  
并不是默写和抄哦。而是每敲一行代码，我都会思考，这行代码有没有必要写
或者有没有更好的方法让我不写这行代码。  
与此同时，敲你们现在看到的文章。  
有用吗？？  
非常有用，在写这篇文章的时候，我又发现了之前的一个值得修改的地方。  
友情链接、书籍推荐这两个地方的后端是两个类组成的。  
只是1+1=2的作用，现在我想到了一个方法可以让1+1=N的写法。后面会介绍。  
现在这个项目的代码量只会越来越少，功能不但没有减少，还增加了无限的可能。  
第一次写可以不记录过程，第二次开始请记录下你的过程，等到你部署上线后，也可以像我一样，立刻可以放出关于Django的博文。  

#### 常见的博客设计的写作技巧
通常博客的右边会是这个博主的个人空间、博客标签云或者分类列表、友情链接、时间归档、推荐的书籍等信息。  
这个部分可以写成一个html文件，例如base_right.html  
注意，不是规范的html文件。  
只是写上一部分的代码，如下：  
```html
{% load diy_tags %}   {# 导入我们的自定义模板标签 #}
<div class="site-me-widget-first">
    <h4 class="title">标签</h4>
    <hr>
    <div class="content community">
        {% get_blog_tag_list as tag_list %}  {# 把函数实例化为变量名 #}
        {% for tag in tag_list %}     {# 通过for循环遍历出内容 #}
            <li class="blog-type-tag"><a target="_blank" href="{% url 'blog_tag' tag.slug %}">{{ tag.name }}</a></li>
        {% empty %}   {# 这个empty是说，假如没有标签的话，显示下面p标签的内容 #}
            <p>暂无标签 敬请期待</p>
        {% endfor %}
    </div>
    <h4 class="title">类型</h4>
    <hr>
    <div class="content community">
        {% get_blog_type_list as type_list %}  {# 把函数实例化为变量名 #}
        {% for type in type_list %}     {# 通过for循环遍历出内容 #}
            <li class="blog-type-tag"><a target="_blank" href="{% url 'blog_type' type.slug %}">{{ type.name }}</a></li>
        {% empty %}   {# 这个empty是说，假如没有标签的话，显示下面p标签的内容 #}
            <p>暂无分类 敬请期待</p>
        {% endfor %}
    </div>
</div>
```
更多的内容自行添加上去。  
当上面的文件完成后，在需要的位置导入即可，例如在blog_list.html中需要用到上面的内容
在需要的地方写入`{% include 'base_right.html' %}`即可。  
#### 代码优化
之前说到，按**标签分类的博客列表**和**按类型分类的博客列表**可以先不用写。  
是因为，只要你在views.py中**所有博客列表**、**标签分类的博客列表**、**按类型分类的博客列表**返回的键名都设定为`blogs`。即可使用下面的方法。  
只要写好blog_list.html。  
在blog_type.html和blog_tag.html中写入一句代码即可，如下：  
`{% extends 'blog_list.html' %}`  
#### 未完待续
还有更多方法等待整理
###  经常遇到的错误信息和问题解答  
下面是我整理的经常遇到的报错信息和问题
#### 我该学那种python的web框架？  
现在主流的python的web框架有Django、Tornado、Flask等等。  
下面讲一下我的个人看法。  
在其他语言了解过或使用过web开发的，自由选择。
纯小白（刚接触python而没有web的概念）先学**Django**，学它的设计理念。     
然后Tornado和Flask二选一。  
Django属于是大而全，Flask属于小而轻、Tornado属于小而精。  
我们学习Django的项目文件布局设计，提高代码的可读性。  
学习Django的各种工具设计例如强大的后台、分页器、ORM。  
然后通过Tornado或Flask再实现一遍这样的功能。相信对你的学习很有帮助。  
有人说Flask比Django好学，简单。  
我不认同，我也用过Flask。  
刚开始，教程告诉你怎么输出`Hello World！`  
代码量的确很少也就一个文件搞定，但是你要设置环境路径等信息，让我觉得很麻烦。  
如果你是个小白、新手、菜鸟。现在让你用Flask打造一个**个人博客**，你要从哪里入手呢？？  
我告诉你吧，如下：
- 把Flask的文件按功能进行切割分配
- 自己手写后台管理系统
- 自己思考怎么分配功能、路由、视图文件在项目中的合理布局。
- 以后拓展业务时，没有通用的业务分配方法。

而一开始学习Django，就不会有上面的问题。  
因为业务方式基本是相同的，我现在的章节对应的项目文件，没放上来是因为，我要把之前存在的一些小瑕疵修改一下，需要点时间。  
以后只上传对应章节的应用。写上README.md。你们只要新建好项目。下载下来，在settings.py加入应用即可使用。可以做到开箱即用的效果。  
Flask和Tornado都做不到。因为他们没有统一的设计要求规范。    
要小白菜鸟做一个设计规范，和让一个不会开车的人开车有区别吗？？  
我也是小白、菜鸟成长过来的，所以我在讲解过程比较注重这方面的问题。
现在先遵守Django的设计规范，然后利用设计规范，最后创造自己的设计规范。  
有点类似于西方奇幻小说的设定。通常主人公的力量一开始要遵守世间的规则（十级前）、利用规则（圣阶）、创造设计规范（领域）、修改或编写源代码（元）。   
让一个一级水平都没有的小白去使用领域的知识。怎么学呢？？
#### 自定义模板标签不生效，且报错
答：自定义标签的函数写错了，或者是写完自定义模板标签后未重启项目。  
注意：每次写完自定义模板标签后，必须重启项目。  
#### 文章的内容变成了html代码  
这是因为你没有使用管道（过滤器），如果在模板上索引的数据是html格式的，需要加上`|safe`。  
例如我们的文章`{{ blog.body_markdown|safe }}`  
还有我们的目录`{{ blog.toc|safe }}`   
这是表示该html是安全的代码，允许嵌入到html代码当中。
#### 文章列表中出现css代码溢出（不知道这个说法对不对）。  
通常我们的博客列表页之类的。会设计成显示一小部分正文，后面加上**阅读全文**。  
溢出的原因是因为我们采取了`|truncatechars:120`这个过滤器。导致html代码结构不完整。  
css代码也会变得不完成导致的。  
限制正文长度的过滤器是下面代码中的truncatechars。  
`{{ blog.body_markdown|safe|truncatechars:120}}`  
在此基础上还要加上`|striptags` ，这是去除css样式的代码。  
写成下面的例子即可  
`{{ blog.body_markdown|safe|truncatechars:120|striptags }}`  
还有一种处理方法是，在models.py中给Blog加多一个内容。**简介**。  
限制其长度，并在模板文件设计中，规定好博客列表中块的长宽。
#### 无法显示博客的标签，且报错。  
通常情况下，在博客列表和博客详情页中，我们需要在文章介绍中显示博客的标签。  
博客的标签可以有一个或者多个。  
但不管它是一个还是多个，它都是一个列表。  
需要用到for来遍历出内容。  
如下面的例子:  
```html
{% for tag in blog.blog_tag %}
    <a href="{% url 'blog_tag' tag.slug  %}">{{ tag.name }}</a>
{% endfor %}
```  
### 开始写你们的代码吧  
阅读到这里，开始写关于博客主体的代码吧。  
遇到难理解的问题可以发邮件到我的邮箱或者加我的微信。  
后续的内容，只涉及设计思路，代码量不多。
